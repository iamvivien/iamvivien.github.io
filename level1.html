<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
        <title>CycleMyLyfe • Level 1</title>
        <meta name="description" content="Road Safety • Level 1">

        <!-- jQuery Plugins -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
		<script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
		<script src="js/link-controls.js"></script>
		<script src="js/camera-position.js"></script>
		<script src="js/aframe-tooltip-component.js"></script>

		<!-- Favicons -->
		<link rel="apple-touch-icon-precomposed" sizes="57x57" href="images/favicomatic/apple-touch-icon-57x57.png" />
		<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/favicomatic/apple-touch-icon-114x114.png" />
		<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/favicomatic/apple-touch-icon-72x72.png" />
		<link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/favicomatic/apple-touch-icon-144x144.png" />
		<link rel="apple-touch-icon-precomposed" sizes="60x60" href="images/favicomatic/apple-touch-icon-60x60.png" />
		<link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/favicomatic/apple-touch-icon-120x120.png" />
		<link rel="apple-touch-icon-precomposed" sizes="76x76" href="images/favicomatic/apple-touch-icon-76x76.png" />
		<link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/favicomatic/apple-touch-icon-152x152.png" />
		<link rel="icon" type="image/png" href="images/favicomatic/favicon-196x196.png" sizes="196x196" />
		<link rel="icon" type="image/png" href="images/favicomatic/favicon-96x96.png" sizes="96x96" />
		<link rel="icon" type="image/png" href="images/favicomatic/favicon-32x32.png" sizes="32x32" />
		<link rel="icon" type="image/png" href="images/favicomatic/favicon-16x16.png" sizes="16x16" />
		<link rel="icon" type="image/png" href="images/favicomatic/favicon-128.png" sizes="128x128" />
		<meta name="application-name" content="&nbsp;"/>
		<meta name="msapplication-TileColor" content="#FFFFFF" />
		<meta name="msapplication-TileImage" content="mstile-144x144.png" />
		<meta name="msapplication-square70x70logo" content="mstile-70x70.png" />
		<meta name="msapplication-square150x150logo" content="mstile-150x150.png" />
		<meta name="msapplication-wide310x150logo" content="mstile-310x150.png" />
		<meta name="msapplication-square310x310logo" content="mstile-310x310.png" />

		<script>
			AFRAME.registerComponent('collider-check', {
				dependencies: ['raycaster'],
				init: function () {
					var timeout;
					this.el.addEventListener('raycaster-intersection-cleared', function(e) {
				  		var error_text = document.getElementById("error_text");
				  		clearTimeout(timeout);
						error_text.setAttribute('text', {
							align:'center',
							width:12,
							wrapCount:100,
							color:'red',
							value:'You have hit someone or something! Please be careful.'
						});

						timeout = setTimeout(function(){
							error_text.setAttribute('text', {
								align:'center',
								width:3,
								wrapCount:100,
								color:'red',
								value:''
							});
						}, 4000);
					});
				}
			});

		</script>
	</head>
	<body>
		<a-scene collider-check>
			
			<!-- ASSETS -->
			<a-assets>
				<a-asset-item id="car" src="models/car_1/scene.gltf"></a-asset-item> 
				<a-asset-item id="woman" src="models/woman/scene.gltf"></a-asset-item>
				<a-asset-item id="road" src="models/road/model.gltf"></a-asset-item>
				<a-asset-item id="sidewalk" src="models/sidewalk/scene.gltf"></a-asset-item>
				<a-asset-item id="bicycle" src="models/bicycle/Bike.gltf"></a-asset-item>
				<a-asset-item id="house" src="models/house/model.gltf"></a-asset-item>
				<a-asset-item id="hdb" src="models/hdb/Apartment.gltf"></a-asset-item>
				<a-asset-item id="oldhouse" src="models/oldhouse/scene.gltf"></a-asset-item>
				<img id="level2_thumbnail" src="images/level2.png">
				<img id="user_thumbnail" src="images/user.png">
			</a-assets>

			<!-- USER MODEL -->
			<a-entity position="0 1.8 50">
				<a-camera id="cam" user-height="1.8" wasd-controls="acceleration: 100">
					<a-entity gltf-model="#bicycle" scale="0.001 0.001 0.001" position="0 -0.5 0" rotation="0 180 0"></a-entity>
					<a-entity id="error_text" position="0 2.138 -5.991"></a-entity>
					<a-sphere raycaster="objects: .collidable; far: 0.4" position="0 0 0" geometry="radius:0.5"></a-sphere>
					<a-entity raycaster="objects: .collidable; far: 0.4" rotation="0 25 0"></a-entity>
					<a-entity raycaster="objects: .collidable; far: 0.4" rotation="0 335 0"></a-entity>
				</a-camera>
			</a-entity>
			
			<!-- ROADS AND WALKWAY -->
			<a-entity id="4" gltf-model="#sidewalk" scale="0.02 0.02 0.02" position="2.854 0.431 3.429" rotation="0 90 0"></a-entity>
		  	<a-entity id="5" gltf-model="#sidewalk" scale="0.02 0.02 0.02" position="2.854 0.431 42.45" rotation="0 90 0"></a-entity>
			<a-entity id="6" gltf-model="#road" scale="4 4 4" position="-4.926 -3.92 -5.734" rotation="0 0 0"></a-entity>
			<a-entity id="7" gltf-model="#road" scale="4 4 4" position="-4.926 -3.92 17.509" rotation="0 0 0"></a-entity>
		  	<a-entity id="8" gltf-model="#road" scale="4 4 4" position="-4.926 -3.92 40.76" rotation="0 0 0"></a-entity>
			<a-entity id="9" gltf-model="#road" scale="4 4 4" position="-16.143 -3.933 -5.734" rotation="0 0 0"></a-entity>
			<a-entity id="10" gltf-model="#road" scale="4 4 4" position="-16.143 -3.918 17.509" rotation="0 0 0"></a-entity>
		  	<a-entity id="11" gltf-model="#road" scale="4 4 4" position="-16.143 -3.918 40.76" rotation="0 0 0"></a-entity>

		  	<!--Buildings -->
		  	<a-entity id="12" gltf-model="#house" scale="5 5 5" position="-3.797 8.399 42.798"></a-entity>
		  	<a-entity id="13" gltf-model="#hdb" position="10.753 0 25.334" rotation="0 270 0"></a-entity>
		  	<a-entity id="14" gltf-model="#oldhouse" scale="0.020 0.020 0.020" position="16.978 0.126 3.486"></a-entity>

			<!-- GROUND AND SKY -->
			<a-entity id="15" environment="ground: flat; groundColor:#454545; groundColor2:#454545;"></a-entity>

			<!-- CAR -->
			<a-entity id="1" class="collidable" geometry="primitive: box" gltf-model="#car" scale="0.02 0.02 0.02" position="-4 0.5 -18.960" rotation="0 0 0">
				<a-sound src="src: url(sounds/street.mp3)" loop="true" autoplay="true" volume="2"></a-sound>
				<a-animation attribute="position"
			  		dur="20000"
			  		fill="forwards"
			  		to="-4 0.5 50.686"
			  		repeat="indefinite"
			  		>
		  		</a-animation>
		  	</a-entity>

			<!-- CAR OPPOSITE DIRECTION -->
			<a-entity id="2" name="car" class="collidable" geometry="primitive: box" gltf-model="#car" scale="0.02 0.02 0.02" position="-16 0.5 57.654" rotation="0 180 0">
				<a-sound src="src: url(sounds/street.mp3)" loop="true" autoplay="true" volume="0.5"></a-sound>
				<a-animation attribute="position"
			  		dur="20000"
			  		fill="backwards"
			  		to="-16 0.5 -12.967"
			  		repeat="indefinite"
			  		>
		  		</a-animation>
			</a-entity>

			<!-- WOMAN -->
			<a-entity id="woman123" name="woman" class="collidable" geometry="primitive: box" gltf-model="#woman" scale="0.011 0.011 0.011"  position="5.752 0.5 -14.869" rotation="0 0 0">
				<a-animation attribute="position"
			  		dur="50000"
			  		fill="forwards"
			  		to="5.752 0.5 59.746"
			  		repeat="indefinite"
			  		>
		  		</a-animation>
			</a-entity>

			<!-- WOMAN TEXT MESSAGE -->
			<a-text id="woman1" value="Please keep to one side when sharing pedestrain walkways" geometry="primitive:plane;height:0.5;width:5" position="5.752 2.7 -14.869" text="align:center" visible="true">
			    <a-animation attribute="position"
	               	dur="50000"
	                fill="forwards"
	                to="5.752 2.7 59.746"
	                repeat="indefinite">         
			    </a-animation>
   			</a-text>

   			<!-- CAR MESSAGE -->
		  	<a-text id="carmsg" value="Please stay clear of oncoming traffic and obey traffic rules" geometry="primitive:plane;height:0.5;width:5" position="-4 2.494 -18.960" text="align:center" visible="true">
			    <a-animation attribute="position"
	               	dur="20000"
	                fill="forwards"
	                to="-4 2.494 50.686"
	                repeat="indefinite">         
			    </a-animation>
   			</a-text>

   			<!-- CHECKPOINT -->
  		 	<a-link href="level2.html" image="#level2_thumbnail" title="Click to proceed to Level 2" position="0 2 -14.869" scale="1 1 1" raycaster="far: 5; objects: [link];" cursor="rayOrigin: mouse" camera-position></a-link>
  		 	<a-link href="user.html" image="#user_thumbnail" title="Click to quit game" position="4 2 -14.869" scale="1 1 1" raycaster="far: 5; objects: [link];" cursor="rayOrigin: mouse" camera-position></a-link>
		</a-scene>

		<!-- jQuery Plugins -->
		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
	</body>
</html>